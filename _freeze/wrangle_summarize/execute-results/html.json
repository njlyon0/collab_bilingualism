{
  "hash": "c0945147a9fb53d1c4eda5566dee9230",
  "result": {
    "markdown": "---\ntitle: \"Summarizing Data\"\n---\n\n\n## Library & Data Loading\n\nBegin by loading any needed libraries and reading in an external data file for use in downstream examples.\n\n:::panel-tabset\n## `<svg aria-label=\"R Project\" role=\"img\" viewBox=\"0 0 581 512\" style=\"height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#FF9B00;overflow:visible;position:relative;\"><title>R Project</title><path d=\"M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z\"/></svg>`{=html} R\n\nLoad the `tidyverse` meta-package as well as our vertebrate data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load needed library\nlibrary(tidyverse)\n\n# Load data\nvert_r <- utils::read.csv(file = file.path(\"data\", \"verts.csv\"))\n\n# Check out first few rows\nhead(vert_r, n = 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  year sitecode section reach pass unitnum unittype vert_index pitnumber\n1 1987 MACKCC-L      CC     L    1       1        R          1        NA\n2 1987 MACKCC-L      CC     L    1       1        R          2        NA\n3 1987 MACKCC-L      CC     L    1       1        R          3        NA\n4 1987 MACKCC-L      CC     L    1       1        R          4        NA\n5 1987 MACKCC-L      CC     L    1       1        R          5        NA\n          species length_1_mm length_2_mm weight_g clip sampledate notes\n1 Cutthroat trout          58          NA     1.75 NONE 1987-10-07      \n2 Cutthroat trout          61          NA     1.95 NONE 1987-10-07      \n3 Cutthroat trout          89          NA     5.60 NONE 1987-10-07      \n4 Cutthroat trout          58          NA     2.15 NONE 1987-10-07      \n5 Cutthroat trout          93          NA     6.90 NONE 1987-10-07      \n```\n:::\n:::\n\n\n## `<svg aria-label=\"Python\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#077DC2;overflow:visible;position:relative;\"><title>Python</title><path d=\"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z\"/></svg>`{=html} Python\n\nLoad the Pandas and `os` libraries as well as our simulated lichen data.\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Load needed libraries\nimport os\nimport pandas as pd\n\n# Load data\nvert_py = pd.read_csv(os.path.join(\"data\", \"verts.csv\"))\n\n# Check out first few rows\nvert_py.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   year  sitecode section reach  ...  weight_g  clip  sampledate  notes\n0  1987  MACKCC-L      CC     L  ...      1.75  NONE  1987-10-07    NaN\n1  1987  MACKCC-L      CC     L  ...      1.95  NONE  1987-10-07    NaN\n2  1987  MACKCC-L      CC     L  ...      5.60  NONE  1987-10-07    NaN\n3  1987  MACKCC-L      CC     L  ...      2.15  NONE  1987-10-07    NaN\n4  1987  MACKCC-L      CC     L  ...      6.90  NONE  1987-10-07    NaN\n\n[5 rows x 16 columns]\n```\n:::\n:::\n\n:::\n\n## Defining Groups\n\nNow that we have data, we can use it to demonstrate groupwise summarization! Both Python and R support defining the grouping structure in one step and then doing the actual summarization in subsequent steps.\n\nLet's suppose that we want to calculate average weight and length within each species and year.\n\n:::panel-tabset\n## `<svg aria-label=\"R Project\" role=\"img\" viewBox=\"0 0 581 512\" style=\"height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#FF9B00;overflow:visible;position:relative;\"><title>R Project</title><path d=\"M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z\"/></svg>`{=html} R\n\nIn R, we use the `group_by` function (from `dplyr`) to define our grouping variables. Note that this changes the class from `data.frame` to `tibble` (a special dataframe-like class defined by the tidyverse in part due to this operation).\n\n`group_by`--like other functions in the tidyverse--allows for 'tidy select' column names where column names are provided without quotes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define grouping variables\nvert_r_grp <- dplyr::group_by(.data = vert_r, year, species)\n\n# Check class of resulting object\nclass(vert_r_grp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"grouped_df\" \"tbl_df\"     \"tbl\"        \"data.frame\"\n```\n:::\n:::\n\n\n## `<svg aria-label=\"Python\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#077DC2;overflow:visible;position:relative;\"><title>Python</title><path d=\"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z\"/></svg>`{=html} Python\n\nIn Python, we can use the `groupby` method (available to all variables of type `DataFrame`). This method does accept multiple column labels but they must be provided as a list (i.e., wrapped in square brackets) and the labels themselves must be wrapped in quotes.\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Define grouping variables\nvert_py_grp = vert_py.groupby([\"year\", \"species\"])\n\n# Check type of resulting variable\ntype(vert_py_grp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.groupby.generic.DataFrameGroupBy'>\n```\n:::\n:::\n\n:::\n\n## Groupwise Summarization\n\nOnce we've established the columns for which we want to calculate summary statistics we can move on to the tools that actually allow summarization steps to take place. Note that _summarization_ implicitly means that we should lose rows because we should only have one row per combination of grouping column content combination. Adding columns is not necessarily summarization if it doesn't shed rows.\n\n:::panel-tabset\n## `<svg aria-label=\"R Project\" role=\"img\" viewBox=\"0 0 581 512\" style=\"height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#FF9B00;overflow:visible;position:relative;\"><title>R Project</title><path d=\"M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z\"/></svg>`{=html} R\n\nR allows for multiple summary metrics to be calculate simultaneously within `dplyr`'s `summarize` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate average weight and length\nvert_r_summary <- dplyr::summarize(.data = vert_r_grp,\n                 avg_weight_g = mean(weight_g, na.rm = T),\n                 length_1_mm = mean(length_1_mm, na.rm = T),\n                 length_2_mm = mean(length_2_mm, na.rm = T))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\n# Check out the first bit of that\nhead(vert_r_summary, n = 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 Ã— 5\n# Groups:   year [4]\n   year species           avg_weight_g length_1_mm length_2_mm\n  <int> <chr>                    <dbl>       <dbl>       <dbl>\n1  1987 \"Cutthroat trout\"         8.96        90.2         NaN\n2  1988 \"Cutthroat trout\"        16.1        115.          NaN\n3  1989 \"Cutthroat trout\"        14.3        107.          NaN\n4  1990 \"\"                      NaN          NaN           NaN\n5  1990 \"Cutthroat trout\"        11.2         94.4         NaN\n```\n:::\n:::\n\n\n## `<svg aria-label=\"Python\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#077DC2;overflow:visible;position:relative;\"><title>Python</title><path d=\"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z\"/></svg>`{=html} Python\n\nWhen summarizing data in Python we need to calculate each metric separately and then combine them. Apologies that this uses the `concat` function in Pandas that we have not previously covered but you can see a greater discussion of these functions/methods in the \"Join\" section.\n\nNote the use of two modes of indexing a particular column.\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Calculate average weight and length\nmean_wt = vert_py_grp[\"weight_g\"].mean()\nmean_ln1 = vert_py_grp.length_1_mm.mean()\nmean_ln2 = vert_py_grp[\"length_2_mm\"].mean()\n\n# Combine them\nvert_py_summary = pd.concat([mean_wt, mean_ln1, mean_ln2], axis = 0)\n\n# Check out that\nvert_py_summary.head(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nyear  species        \n1987  Cutthroat trout     8.959867\n1988  Cutthroat trout    16.073510\n1989  Cutthroat trout    14.308766\n1990  Cutthroat trout    11.212827\n1991  Cutthroat trout     9.150639\ndtype: float64\n```\n:::\n:::\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}